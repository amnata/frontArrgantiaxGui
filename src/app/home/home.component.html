<div class="home-container">

  <!-- ===== HEADER MODERNE AVEC GLASSMORPHISM ===== -->
  <header class="header-section">
    <div class="header-particles"></div>
    <div class="header-content">

      <!-- Top du header avec salutation et ic√¥nes -->
      <div class="header-top">
        <div class="greeting-wrapper">
          <h1 class="greeting">Bonjour {{ user?.prenom }} üëã</h1>
          <p class="greeting-subtitle">Que souhaitez-vous faire aujourd'hui ?</p>
        </div>

        <!-- Actions -->
        <div class="header-actions">
          <!-- M√©t√©o compacte -->
          <div class="weather-compact" *ngIf="todayWeather">
            <div class="weather-icon">üå§Ô∏è</div>
            <div class="weather-info">
              <span class="weather-temp">{{ todayWeather.main.temp }}¬∞C</span>
              <span class="weather-desc">{{ todayWeather.weather[0].description }}</span>
            </div>
          </div>

          <!-- Notification -->
          <button class="icon-button notif-button" (click)="goToAlerts()" [class.has-notif]="unreadCount > 0">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
            <span *ngIf="unreadCount > 0" class="notif-badge">{{ unreadCount }}</span>
          </button>

          <!-- Param√®tres -->
          <button class="icon-button settings-button" (click)="openSettings()">
           <img src="../../assets/settings.png" alt="" class="param">
          </button>
        </div>
      </div>

      <!-- Menu overlay -->
      <app-setting *ngIf="showSettings" (close)="closeSettings()"></app-setting>

      <!-- BANNIERE D'ALERTE -->
      <app-alert-banner></app-alert-banner>

      <!-- WIDGET CONSEIL DU JOUR -->
      <app-daily-tip-widget></app-daily-tip-widget>

      <!-- Barre de recherche moderne -->
      <div class="search-container">
        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input type="text" placeholder="Rechercher une plante, maladie..." class="search-input" />
        <button class="search-filter-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
          </svg>
        </button>
      </div>

    </div>
  </header>

  <!-- ===== CONTENU PRINCIPAL ===== -->
  <main class="main-content">

    <!-- SECTION: Fonctionnalit√©s principales avec cards modernes -->
    <section class="section features-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="title-icon">‚ö°</span>
          Fonctionnalit√©s
        </h2>
        <p class="section-subtitle">Outils pour g√©rer vos cultures</p>
      </div>

      <div class="features-grid">
        <button class="feature-card feature-detection" (click)="navigateToDetection()">
          <div class="feature-icon-wrapper">
            <svg class="feature-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
              <circle cx="12" cy="13" r="4"></circle>
            </svg>
          </div>
          <div class="feature-content">
            <h3 class="feature-title">D√©tection</h3>
            <p class="feature-desc">Scanner et identifier les maladies</p>
          </div>
          <div class="feature-arrow">‚Üí</div>
        </button>
        
        <button class="feature-card feature-classification" (click)="navigateToClassification()">
          <div class="feature-icon-wrapper">
            <svg class="feature-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"></path>
              <path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"></path>
            </svg>
          </div>
          <div class="feature-content">
            <h3 class="feature-title">Classification</h3>
            <p class="feature-desc">Classifier vos plantes facilement</p>
          </div>
          <div class="feature-arrow">‚Üí</div>
        </button>

        <button class="feature-card feature-suivi" (click)="navigateToSuivi()">
          <div class="feature-icon-wrapper">
            <svg class="feature-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
          </div>
          <div class="feature-content">
            <h3 class="feature-title">Suivi Culture</h3>
            <p class="feature-desc">Suivez l'√©volution de vos cultures</p>
          </div>
          <div class="feature-arrow">‚Üí</div>
          <span *ngIf="!isAuthenticated" class="auth-badge">üîí</span>
        </button>
      </div>
    </section>

    <!-- SECTION: D√©couvrir plus de plantes -->
    <section class="section plants-discover-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="title-icon">üå±</span>
          D√©couvrir plus de plantes
        </h2>
        <button class="see-all-btn">Voir tout ‚Üí</button>
      </div>

      <div class="plants-scroll">
        <div *ngFor="let plant of discoveredPlants" class="plant-card-modern" 
             (click)="viewPlantDetails(plant.id)">
          <div class="plant-image-modern">
            <span class="plant-emoji-modern">{{ plant.emoji }}</span>
            <div class="plant-overlay">
              <span class="view-icon">üëÅÔ∏è</span>
            </div>
          </div>
          <div class="plant-info-modern">
            <h3 class="plant-name-modern">{{ plant.name }}</h3>
            <p class="plant-desc-modern">{{ plant.description }}</p>
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION: Les plantes les plus cultiv√©es -->
    <section class="section popular-plants-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="title-icon">üî•</span>
          Les plus cultiv√©es
        </h2>
        <span class="trending-badge">Tendances</span>
      </div>

      <div class="popular-plants-list">
        <div *ngFor="let plant of popularPlants; let i = index" 
             class="popular-plant-item"
             (click)="viewPlantDetails(plant.id)">
          <div class="plant-rank">{{ i + 1 }}</div>
          <div class="plant-emoji-circle">{{ plant.emoji }}</div>
          <div class="plant-details">
            <h3 class="plant-title">{{ plant.name }}</h3>
            <p class="plant-subtitle">{{ plant.description }}</p>
          </div>
          <svg class="chevron-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </div>
      </div>
    </section>

  </main>

  <!-- Chatbot -->
  <app-chatbot></app-chatbot>

  <!-- Boutons de test (√† retirer en production) -->
  <div class="weather-test">
    <button (click)="simulate('rain')"><img src="../../assets/rainy.png" alt="Pluie" class="param"></button>
    <button (click)="simulate('heat')"><img src="../../assets/hot.png" alt="Forte Chaleur" class="param">></button>
    <button (click)="simulate('cold')"><img src="../../assets/snowy.png" alt="Neige" class="param">></button>
  </div>

</div>